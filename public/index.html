<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>chat app</title>
</head>
<body>

    <h1>Chat App</h1>
    <p>connect count <span id="connectCount"></span></p>
    <input type="text" placeholder="enter your name" id="name"><br><br>
    <input type="text" placeholder="enter your message" id="msg"><br><br>
    <button onclick="sendMessage()">send message</button>
    <div id="messageContainer">

    </div>

    <script src="http://localhost:8080/socket.io/socket.io.js"></script>
    <script>
        let socketClient = io();

        function sendMessage(){
            let name = document.getElementById("name").value;
            let message = document.getElementById("msg").value;
            socketClient.emit("message",name,message)
        }

        let messageNo = 0;
        let messageContainer = document.getElementById("messageContainer")
        socketClient.on("message",(name,message)=>{
            messageNo++;
            let userNameOfThisClient = document.getElementById("name").value;
            if(name == userNameOfThisClient){
                messageContainer.innerHTML += `<p id = "messageNo${messageNo}"> ${name} : ${message}
                    <button onclick = 'deleteMessage("messageNo${messageNo}")'> delete Message </button>
                </p>`
            }else{
                messageContainer.innerHTML += `<p id = "messageNo${messageNo}"> ${name} : ${message}</p>`
            }
            
        });

        function deleteMessage(id){
            socketClient.emit("deleteMessage",id);
        }
        socketClient.on("deleteMessage",(id)=>{
            document.getElementById(id).remove();
        })

        let connectCount = document.getElementById("connectCount")
        socketClient.on("connection",(userCount)=>{
            connectCount.innerHTML = userCount;
        })
    </script>
</body>
</html>